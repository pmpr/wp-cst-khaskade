<?php
/*   _______________________________________
    |  Obfuscated by PMPR - Php Obfuscator  |
    |             69a0b91ce2cd2             |
    |_______________________________________|
*/
 namespace Pmpr\Custom\Khaskade\OrderCampaign; use Pmpr\Common\Foundation\Interfaces\Constants; use Pmpr\Custom\Khaskade\Container; use Pmpr\Custom\Khaskade\OrderCampaign\Model\Campaign; use Pmpr\Custom\Khaskade\OrderCampaign\Model\Recipient; use Pmpr\Custom\Khaskade\Setting; class OrderCampaign extends Container { const saeiuooweywkgiew = 1; public function wigskegsqequoeks() { $this->qcsmikeggeemccuu(Process::uqoegwmwmgagayqe, [$this, 'qqaqykcokwwauceq'], 10, 2)->qcsmikeggeemccuu(Process::mimoekquwcqqmgmy, [$this, 'kkmeemycmouweugs'], 10, 2)->qcsmikeggeemccuu(Process::qiqagssumogewkcs, [$this, 'amkcoyscycskuuak'], 10, 2); } public function mameiwsayuyquoeq() { if ($this->caokeucsksukesyo()->owicscwgeuqcqaig()->awumyiewiaosiyyy()) { Campaign::symcgieuakksimmu(); Recipient::symcgieuakksimmu(); } if ($this->caokeucsksukesyo()->owicscwgeuqcqaig()->mcgoysmkqsqooceq(Ajax::PREFIX)) { Ajax::symcgieuakksimmu(); } } public function amkcoyscycskuuak($auqocuuuaeqmowey) { $maeucqmymoaoscug = pr_sms_get_engine(); $ssomcowigcegquqo = $this->weysguygiseoukqw(Setting::ggoqyuiuyiyyessk, $maeucqmymoaoscug::kuqegimyiaaekcmu); $eawuoscsaksyqwiw = $this->caokeucsksukesyo()->mskuyeumceaigegs(); if ($ssomcowigcegquqo) { $iwigiqwyskocowwo = $maeucqmymoaoscug->kkcowsyecqiosuko($ssomcowigcegquqo); if ($iwigiqwyskocowwo) { $eqwoegegiamegqsm = $this->caokeucsksukesyo()->skckwsgymkimyuwo(); $qesogoiaeaseaokq = Recipient::symcgieuakksimmu(); $weyoqgcesqgeusiu = self::saeiuooweywkgiew; $ieumguagaqqsweew = $qesogoiaeaseaokq->iekyeyicoyyawomk()->ssiyoimagsskwsoi($eqwoegegiamegqsm->kyckwuuiqwmyoqma()->mmiqqgoaeccgwoqs($eqwoegegiamegqsm->megqywqeuquawkim($qesogoiaeaseaokq::iuyuwaomgikisgww, $auqocuuuaeqmowey))->mmiqqgoaeccgwoqs($eqwoegegiamegqsm->megqywqeuquawkim(Constants::ciywsqoeiymemsys, [Constants::sgoswgskyiiwkyuo, Constants::yokwumqkioggkqsk]))->wsacuksekeaemucu($weyoqgcesqgeusiu), $qesogoiaeaseaokq::oaweaiksmesocyqw); $sogksuscggsicmac = $iwigiqwyskocowwo->uiqqikcuycqyeooa($ieumguagaqqsweew); if (!is_wp_error($sogksuscggsicmac)) { if (empty($sogksuscggsicmac)) { $eawuoscsaksyqwiw->kauiuueiiekqcqwo('The SMS campaign sending process failed: api response is empty.', PR__CST__KHASKADE); } else { $iwigiqwyskocowwo->meuqqaesciayesoo($sogksuscggsicmac, $qesogoiaeaseaokq, [$qesogoiaeaseaokq::iuyuwaomgikisgww => $auqocuuuaeqmowey]); if (count($ieumguagaqqsweew) < $weyoqgcesqgeusiu) { $eawuoscsaksyqwiw->kauiuueiiekqcqwo('The SMS campaign status check process has been completed.', PR__CST__KHASKADE, Constants::smkwuwawwaqyimcq); } else { Process::symcgieuakksimmu()->awiesgqkuowosqso($auqocuuuaeqmowey, 5); } } } else { $eawuoscsaksyqwiw->kauiuueiiekqcqwo(sprintf('The SMS campaign status check process failed: %s.', $this->caokeucsksukesyo()->euekiyuksecoccus()->skauuuoqcaiseuks($sogksuscggsicmac)), PR__CST__KHASKADE); } } else { $eawuoscsaksyqwiw->kauiuueiiekqcqwo(sprintf('The SMS campaign status check process failed: provider "%s" not found or not configured.', $ssomcowigcegquqo), PR__CST__KHASKADE); } } else { $eawuoscsaksyqwiw->kauiuueiiekqcqwo('The SMS campaign status check process failed: provider is empty.', PR__CST__KHASKADE); } } public function kkmeemycmouweugs($auqocuuuaeqmowey, $suaemuyiacqyugsm = 1) { $maeucqmymoaoscug = pr_sms_get_engine(); $ssomcowigcegquqo = $this->weysguygiseoukqw(Setting::ggoqyuiuyiyyessk, $maeucqmymoaoscug::kuqegimyiaaekcmu); $ayakoikewusskayc = null; $kquicscwosekgweg = Campaign::symcgieuakksimmu(); $eawuoscsaksyqwiw = $this->caokeucsksukesyo()->mskuyeumceaigegs(); if ($ssomcowigcegquqo) { $iwigiqwyskocowwo = $maeucqmymoaoscug->kkcowsyecqiosuko($ssomcowigcegquqo); if ($iwigiqwyskocowwo) { $eqwoegegiamegqsm = $this->caokeucsksukesyo()->skckwsgymkimyuwo(); $qesogoiaeaseaokq = Recipient::symcgieuakksimmu(); $qmyggacwqesycaey = $kquicscwosekgweg->iekyeyicoyyawomk()->akkkoiiymmamsauc($auqocuuuaeqmowey); if ($uamcoiueqaamsqma = trim((string) $kquicscwosekgweg->waecsyqmwascmqoa($qmyggacwqesycaey, Constants::eoskkkieowogacws, ''))) { $weyoqgcesqgeusiu = self::saeiuooweywkgiew; $euuagqogsaeccmgs = $qesogoiaeaseaokq->iekyeyicoyyawomk()->ssiyoimagsskwsoi($eqwoegegiamegqsm->kyckwuuiqwmyoqma()->mmiqqgoaeccgwoqs($eqwoegegiamegqsm->megqywqeuquawkim($qesogoiaeaseaokq::iuyuwaomgikisgww, $auqocuuuaeqmowey))->mmiqqgoaeccgwoqs($eqwoegegiamegqsm->megqywqeuquawkim(Constants::ciywsqoeiymemsys, Constants::oomiykwyawmigaui))->wsacuksekeaemucu($weyoqgcesqgeusiu)->swceescgsocwwaqc(($suaemuyiacqyugsm - 1) * $weyoqgcesqgeusiu), Constants::skogicecygyyskkq); $msugeqywccmmmgyu = $this->weysguygiseoukqw(Setting::ucyquuimkwskaegq, ''); if ($msugeqywccmmmgyu) { $msugeqywccmmmgyu = $iwigiqwyskocowwo->rsmwamsowgaimcsy($msugeqywccmmmgyu); } $sogksuscggsicmac = $iwigiqwyskocowwo->ysqiukeauuqcuosw($euuagqogsaeccmgs, $uamcoiueqaamsqma, $msugeqywccmmmgyu); if (!is_wp_error($sogksuscggsicmac)) { if (empty($sogksuscggsicmac)) { $ayakoikewusskayc = Constants::uasuowkaguiwoouw; $eawuoscsaksyqwiw->kauiuueiiekqcqwo('The SMS campaign sending process failed: api response is empty.', PR__CST__KHASKADE); } else { $iwigiqwyskocowwo->okogmmomueiegyga($sogksuscggsicmac, $qesogoiaeaseaokq, [$qesogoiaeaseaokq::iuyuwaomgikisgww => $auqocuuuaeqmowey]); if (count($euuagqogsaeccmgs) < $weyoqgcesqgeusiu) { $ayakoikewusskayc = Constants::amcogigwsaqssuai; $eawuoscsaksyqwiw->kauiuueiiekqcqwo('The SMS campaign sending process has been completed.', PR__CST__KHASKADE, Constants::smkwuwawwaqyimcq); Process::symcgieuakksimmu()->awiesgqkuowosqso($auqocuuuaeqmowey); } else { Process::symcgieuakksimmu()->iqysqeioksweckek($auqocuuuaeqmowey, $suaemuyiacqyugsm + 1); } } } else { $ayakoikewusskayc = Constants::uasuowkaguiwoouw; $eawuoscsaksyqwiw->kauiuueiiekqcqwo(sprintf('The SMS campaign sending process failed: Response Error: %s.', $this->caokeucsksukesyo()->euekiyuksecoccus()->skauuuoqcaiseuks($sogksuscggsicmac)), PR__CST__KHASKADE); } } else { $ayakoikewusskayc = Constants::uasuowkaguiwoouw; $eawuoscsaksyqwiw->kauiuueiiekqcqwo('The SMS campaign sending process failed: campaign message is empty.', PR__CST__KHASKADE); } } else { $ayakoikewusskayc = Constants::uasuowkaguiwoouw; $eawuoscsaksyqwiw->kauiuueiiekqcqwo(sprintf('The SMS campaign sending process failed: provider "%s" not found or not configured.', $ssomcowigcegquqo), PR__CST__KHASKADE); } } else { $ayakoikewusskayc = Constants::uasuowkaguiwoouw; $eawuoscsaksyqwiw->kauiuueiiekqcqwo('The SMS campaign sending process failed: provider is empty.', PR__CST__KHASKADE); } if ($ayakoikewusskayc) { $sogksuscggsicmac = $kquicscwosekgweg->gssiscqyqsacmeca()->wqikesawekycweoi($auqocuuuaeqmowey, [Constants::ciywsqoeiymemsys => $ayakoikewusskayc]); if (is_wp_error($sogksuscggsicmac)) { $eawuoscsaksyqwiw->kauiuueiiekqcqwo(sprintf('Can not change campaign status: %s.', $this->caokeucsksukesyo()->euekiyuksecoccus()->skauuuoqcaiseuks($sogksuscggsicmac)), PR__CST__KHASKADE); } } } public function qqaqykcokwwauceq($auqocuuuaeqmowey, $suaemuyiacqyugsm = 1) { $kquicscwosekgweg = Campaign::symcgieuakksimmu(); $eawuoscsaksyqwiw = $this->caokeucsksukesyo()->mskuyeumceaigegs(); $qmyggacwqesycaey = $kquicscwosekgweg->imgymusqgccqsqqq($auqocuuuaeqmowey); $yykmaicmmgywoace = $kquicscwosekgweg->ogegcqqcukiaqscy(Constants::ciywsqoeiymemsys, $qmyggacwqesycaey); if ($yykmaicmmgywoace !== Constants::qgmyyeewkieecqck) { $eawuoscsaksyqwiw->kauiuueiiekqcqwo(sprintf('Campaign %s status not processing and already changed to %s.', $kquicscwosekgweg->uikgwcuascgeissw($qmyggacwqesycaey), $kquicscwosekgweg->yomgsemomcmgekyi(Constants::ciywsqoeiymemsys, $qmyggacwqesycaey)), PR__CST__KHASKADE, Constants::smkwuwawwaqyimcq); } else { $qqacemimwuamsqqc = $this->uwkmaywceaaaigwo()->mmmcswscsiecscwg(); $uuyoeicyoayimaoa = self::saeiuooweywkgiew; $iymqeycmaikgmoau = $kquicscwosekgweg->waecsyqmwascmqoa($qmyggacwqesycaey, $kquicscwosekgweg::awqiseegccssqwws); $yooaaeuioeawcqms = $kquicscwosekgweg->waecsyqmwascmqoa($qmyggacwqesycaey, $kquicscwosekgweg::awqiseegccssqwws); $seusouwwgeqagsce = $kquicscwosekgweg->waecsyqmwascmqoa($qmyggacwqesycaey, $kquicscwosekgweg::mocayuwikwumcmym); $yooaaeuioeawcqms = date('Y-m-d 00:00:00', strtotime($yooaaeuioeawcqms)); $seusouwwgeqagsce = date('Y-m-d 23:59:59', strtotime($seusouwwgeqagsce)); $kswooiskywsugoyw = $qqacemimwuamsqqc->ciugwooasaqcywas([Constants::imywcsggckkcywgk => $suaemuyiacqyugsm, Constants::cgiswgcumueqgcmw => $uuyoeicyoayimaoa, Constants::ssewswaiouwqieog => Constants::oyaoekcogwkcekcc, Constants::ciywsqoeiymemsys => $iymqeycmaikgmoau, Constants::emakkoeakyciuask => $yooaaeuioeawcqms . '...' . $seusouwwgeqagsce]); $yoiguusocukqeayg = $this->uwkmaywceaaaigwo()->issssuygyewuaswa(); $qesogoiaeaseaokq = Recipient::symcgieuakksimmu(); $agiwqcgsmkuiiiqo = $qesogoiaeaseaokq->iekyeyicoyyawomk(); foreach ($kswooiskywsugoyw as $gkkgcoiwayaccqgm) { $umwqusowiqmyseom = $qqacemimwuamsqqc->get($gkkgcoiwayaccqgm); if (empty($umwqusowiqmyseom)) { continue; } $ycoeoaakqyskgykq = $umwqusowiqmyseom->get_customer_id(); $iomcqougosimesoq = $umwqusowiqmyseom->get_billing_phone(); if (empty($iomcqougosimesoq) && !empty($ycoeoaakqyskgykq)) { $iomcqougosimesoq = $yoiguusocukqeayg->igawqaomowicuayw('billing_phone', $ycoeoaakqyskgykq); } $iomcqougosimesoq = preg_replace('/[^0-9]/', '', $iomcqougosimesoq); if (empty($iomcqougosimesoq)) { continue; } if ($agiwqcgsmkuiiiqo->kiaweikcmkuqseuu([Constants::skogicecygyyskkq => $iomcqougosimesoq, $qesogoiaeaseaokq::iuyuwaomgikisgww => $auqocuuuaeqmowey])) { continue; } $sogksuscggsicmac = $qesogoiaeaseaokq->gssiscqyqsacmeca()->gsegsiocqmsoayii([Constants::yauicucwkgqyygas => $ycoeoaakqyskgykq, Constants::skogicecygyyskkq => $iomcqougosimesoq, Constants::ciywsqoeiymemsys => Constants::oomiykwyawmigaui, $qesogoiaeaseaokq::iuyuwaomgikisgww => $auqocuuuaeqmowey]); if (is_wp_error($sogksuscggsicmac)) { $eawuoscsaksyqwiw->kauiuueiiekqcqwo(sprintf('Error on adding recipients: %s.', $this->caokeucsksukesyo()->euekiyuksecoccus()->skauuuoqcaiseuks($sogksuscggsicmac)), PR__CST__KHASKADE); return; } } if (count($kswooiskywsugoyw) < $uuyoeicyoayimaoa) { $sogksuscggsicmac = $kquicscwosekgweg->gssiscqyqsacmeca()->wqikesawekycweoi($qmyggacwqesycaey, [Constants::ciywsqoeiymemsys => Constants::oomiykwyawmigaui]); if (is_wp_error($sogksuscggsicmac)) { $eawuoscsaksyqwiw->kauiuueiiekqcqwo(sprintf('Error on update campaign status: %s.', $this->caokeucsksukesyo()->euekiyuksecoccus()->skauuuoqcaiseuks($sogksuscggsicmac)), PR__CST__KHASKADE); } } else { Process::symcgieuakksimmu()->iaikqquqgiouoaks($auqocuuuaeqmowey, $suaemuyiacqyugsm + 1); } } } }
